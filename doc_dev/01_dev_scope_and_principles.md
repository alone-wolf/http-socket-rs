# 开发范围与硬性原则

## 1. 开发范围

本阶段只实现 `http-socket` 框架内核与约定扩展面，不实现业务框架能力。

必须覆盖：

- 会话生命周期与状态机。
- transport 能力协商与选择。
- Builder-first 公共 API。
- 错误分层与统一包装。
- feature 可裁剪构建。

不在本阶段覆盖：

- 业务路由系统。
- 业务鉴权协议细节（仅提供扩展接口）。
- 特定云厂商存储/监控绑定实现。

## 2. 硬性开发原则

1. **协商先于启用**：任何可选能力必须协商成功后启用。
2. **session 为主，transport 可替换**：重连时保留 session 身份与协议状态。
3. **核心最小化**：可选能力必须通过 feature 或扩展 trait 外置。
4. **稳定扩展面**：扩展仅依赖公共 trait，不依赖内部私有结构。
5. **兼容优先**：新增能力默认走增量扩展路径，避免破坏性变更。

## 3. 开发前检查

- [ ] 是否满足 `doc_design/12_pre_implementation_guardrails.md` 清单。
- [ ] 新增模块是否有明确职责与边界。
- [ ] 新增类型是否会导致顶层泛型扩散。
- [ ] 新增 feature 是否默认关闭并隔离依赖。
